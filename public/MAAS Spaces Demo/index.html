
<!DOCTYPE html>
<html lang="en-us">

    <head>

        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />

        <meta property="og:title" content=" MAAS Spaces Demo &middot;  Juju Sapphire team" />
        <meta property="og:site_name" content="Juju Sapphire team" />
        <meta property="og:url" content="http://juju-sapphire.github.io/MAAS%20Spaces%20Demo/" />

    
        <meta property="og:type" content="article" />
        <meta property="og:article:published_time" content="2016-01-27T00:00:00Z" />
        

        <meta name="twitter:card" content="summary" />
        <meta name="twitter:site" content="@" />
        <meta name="twitter:creator" content="@" />
        <meta name="twitter:title" content="MAAS Spaces Demo" />
        <meta name="twitter:description" content="" />
        <meta name="twitter:url" content="http://juju-sapphire.github.io/MAAS%20Spaces%20Demo/" />
    

        <title> MAAS Spaces Demo &middot;  Juju Sapphire team</title>

    
        <meta name="description" content="" />
    

        <meta name="p:domain_verify" content="fc173d84e3a4de948ed4bda2908afd3e"/>
        <meta name="HandheldFriendly" content="True" />
        <meta name="MobileOptimized" content="320" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        
        

    
        <link href="http://juju-sapphire.github.ioindex.xml" rel="alternate" type="application/rss+xml" title="Juju Sapphire team" />
    

    
        <link rel="canonical" href="http://juju-sapphire.github.io/MAAS%20Spaces%20Demo/" />

    
    <script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "Article",
        "headline": "MAAS Spaces Demo",
        "author": {
            "@type": "Person",
            "name": "http://profiles.google.com/?rel=author"
        },
        "datePublished": "2016-01-27",
        "description": "",
        "wordCount":  645 
    }
    </script>
    

    <style>
@charset "UTF-8";article,header,img,main,nav,section{display:block}blockquote,p,pre,ul{margin:2em auto}#wrapper,pre{width:100%;box-sizing:border-box}#nav,#wrapper,code{position:relative}#nav,body{background:#fff}#menu,blockquote,pre code{background:0 0}#menu,#menu .menu-header,#menu .menu-list,#wrapper,.post-nav .post-nav-item .post-nav-teaser .post-nav-info,blockquote,pre{box-sizing:border-box}img{border:0;max-width:100%;height:auto;margin:2.5em auto}html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}code,pre{font-family:monospace,monospace;font-size:1em}@font-face{font-family:'Merriweather Sans';font-style:normal;font-weight:300;src:local("Merriweather Sans Light"),local("MerriweatherSans-Light"),url(//fonts.gstatic.com/s/merriweathersans/v5/6LmGj5dOJopQKEkt88GowY_zIojJi0m4a5Z6tRh6itY.woff) format("woff")}@font-face{font-family:'Merriweather Sans';font-style:normal;font-weight:400;src:local("Merriweather Sans Regular"),local("MerriweatherSans-Regular"),url(//fonts.gstatic.com/s/merriweathersans/v5/AKu1CjQ4qnV8MUltkAX3sL2aU247V0zTzydO4RoO9Ok.woff) format("woff")}@font-face{font-family:'Merriweather Sans';font-style:normal;font-weight:700;src:local("Merriweather Sans Bold"),local("MerriweatherSans-Bold"),url(//fonts.gstatic.com/s/merriweathersans/v5/6LmGj5dOJopQKEkt88GowQfd-b-I5PxxcmB4_-MNcqw.woff) format("woff")}@font-face{font-family:'Merriweather Sans';font-style:normal;font-weight:800;src:local("Merriweather Sans ExtraBold"),local("MerriweatherSans-ExtraBold"),url(//fonts.gstatic.com/s/merriweathersans/v5/6LmGj5dOJopQKEkt88GowWT7sFQ1Iz1BbpcuCPlgc9Q.woff) format("woff")}@font-face{font-family:'Merriweather Sans';font-style:italic;font-weight:300;src:local("Merriweather Sans Light Italic"),local("MerriweatherSans-LightItalic"),url(//fonts.gstatic.com/s/merriweathersans/v5/nAqt4hiqwq3tzCecpgPmVX9UU5BmOJGkLxUCVv5VXdc.woff) format("woff")}@font-face{font-family:'Merriweather Sans';font-style:italic;font-weight:400;src:local("Merriweather Sans Italic"),local("MerriweatherSans-Italic"),url(//fonts.gstatic.com/s/merriweathersans/v5/3Mz4hOHzs2npRMG3B1ascf0KIgDhPIHb_R-SWdtqte8.woff) format("woff")}@font-face{font-family:'Merriweather Sans';font-style:italic;font-weight:700;src:local("Merriweather Sans Bold Italic"),local("MerriweatherSans-BoldItalic"),url(//fonts.gstatic.com/s/merriweathersans/v5/nAqt4hiqwq3tzCecpgPmVYM8pfYvjMoOxygpzLVILAs.woff) format("woff")}@font-face{font-family:Inconsolata;font-style:normal;font-weight:400;src:local("Inconsolata"),url(//fonts.gstatic.com/s/inconsolata/v12/BjAYBlHtW3CJxDcjzrnZCIbN6UDyHWBl620a-IRfuBk.woff) format("woff")}@font-face{font-family:Inconsolata;font-style:normal;font-weight:700;src:local("Inconsolata Bold"),local("Inconsolata-Bold"),url(//fonts.gstatic.com/s/inconsolata/v12/AIed271kqQlcIRSOnQH0yTqR_3kx9_hJXbbyU8S6IN0.woff) format("woff")}@font-face{font-family:icons;src:url(../fonts/icons.eot?9273991);src:url(../fonts/icons.eot?9273991#iefix) format("embedded-opentype"),url(../fonts/icons.woff?9273991) format("woff"),url(../fonts/icons.ttf?9273991) format("truetype"),url(../fonts/icons.svg?9273991#icons) format("svg");font-weight:400;font-style:normal}[class^=icon-]:before{font-family:icons;font-style:normal;font-weight:400;speak:none;display:inline-block;text-decoration:inherit;width:1em;margin-right:.2em;text-align:center;font-variant:normal;text-transform:none;line-height:1em;margin-left:.2em;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.icon-arrow-left:before{content:'\e804'}.icon-arrow-right:before{content:'\e807'}.icon-rss:before{content:'\e808'}.icon-menu:before{content:'\e809'}body{margin:0;font:300 1em/1.5em 'Merriweather Sans',sans-serif;color:#595B66}blockquote,i{font-style:italic}code,pre{font-family:Inconsolata,monospace}a,blockquote,code,i{font-weight:400}::-moz-selection{color:#222;background:#D6EDFF;text-shadow:none}::-moz-selection,::selection{color:#222;background:#D6EDFF;text-shadow:none}a{background-color:transparent;color:inherit;text-decoration:none;transition:all ease-out .2s}.post-content a{border-bottom:2px solid #36D995}h1,h4{text-rendering:optimizeLegibility;color:#1F2026}h1{font-size:2em;line-height:1em;margin:2em 0 -.5em}h4{font-size:1.25em;line-height:1.2em;margin:2.4em 0 -.8em}ul{list-style:none;padding-left:3em}blockquote{padding:0 1em;border-left:.25em solid #D4D5D9;color:#595B66}blockquote *{margin:1em auto}blockquote :first-child{margin-top:0}blockquote :last-child{margin-bottom:0}i{color:#363740}code{display:inline-block;top:-1px;padding:3px 6px;margin:-1px 2px;font-size:.875em;line-height:1.143em;background:#E1E2E6;color:#000;border-radius:2px}pre{padding:1em;white-space:pre;overflow:auto;background:#9D9FA6;color:#fff}pre code{position:static;top:auto;font-size:1em;line-height:1.5em;white-space:-moz-pre-wrap;white-space:pre-wrap;vertical-align:inherit;border:none;padding:0}#menu .menu-header:before,.post .post-title:before{border-bottom:4px solid #36D995;content:''}.inner{max-width:48em;margin:0 auto;padding:0 1em}#wrapper{min-height:100vh;padding-bottom:6em;background:#F2F3F5}#push{-webkit-transform:translate3d(0,0,0);transform:translate3d(0,0,0);-webkit-transform-style:preserve-3d;transform-style:preserve-3d;opacity:1}#nav{z-index:70;transition:all ease-out .4s;-webkit-transform:translate3d(0,0,0);transform:translate3d(0,0,0);-webkit-transform-style:preserve-3d;transform-style:preserve-3d;opacity:1}#nav:after{clear:both;content:'';display:table}#nav .nav-logo{float:left;height:2em;padding:1em;max-width:50%}#nav .nav-logo img{width:auto;max-width:none;height:2em;margin:0}#nav .nav-menu{float:right}#nav .nav-menu:after{clear:both;content:'';display:table}#nav .nav-menu a{display:block;width:1em;height:1em;line-height:1em;padding:1.5em;text-align:center;float:left;cursor:pointer}#nav .nav-menu a i:before{margin:auto}#menu{display:none;position:fixed;left:50%;top:5%;width:30em;height:90%;margin-left:-15em;padding:3em 0 0;overflow:hidden;transition:all ease-out .3s;-webkit-transform:translate3d(0,2em,0);transform:translate3d(0,2em,0);-webkit-transform-style:preserve-3d;transform-style:preserve-3d;opacity:0;z-index:100}@media only screen and (max-width:50em){#menu{width:90%;left:5%;margin-left:auto}}#menu .menu-header{position:absolute;left:0;top:0;width:100%;height:3.5em;padding:1em 1.5em .5em;margin-bottom:1em;line-height:2em;z-index:110;background:#fff}#menu .menu-header:before{position:absolute;left:-5%;bottom:-1em;width:110%;height:2em;background:#fff;box-shadow:0 .125em .125em rgba(0,0,0,.1);-webkit-transform:rotate(2.5deg);transform:rotate(2.5deg);transition:all ease-out .2s;z-index:115}#menu .menu-header:after{clear:both;content:'';display:table}#menu .menu-header .menu-label{position:relative;display:block;float:left;z-index:120}#menu .menu-header .menu-close{position:relative;display:block;float:right;width:2em;height:2em;padding:1em;margin:-1em -1.5em -1em 0;cursor:pointer;z-index:125}#menu .menu-header .menu-close:after,#menu .menu-header .menu-close:before{content:'';position:absolute;left:50%;top:50%;background:#9D9FA6;-webkit-transform:rotate(45deg);transform:rotate(45deg)}.overlay,.overlay:before{top:0;width:100%;height:100%}#menu .menu-header .menu-close:after{width:2px;height:1em;margin:-.5em 0 0 -1px}#menu .menu-header .menu-close:before{width:1em;height:2px;margin:-1px 0 0 -.5em}#menu .menu-list{position:relative;list-style:none;margin:0;padding:2em 0;height:100%;overflow-x:hidden;overflow-y:scroll;background:#fff}.overlay{position:fixed;left:0;z-index:80;display:none}.overlay:before{content:'';position:absolute;left:0;background:#1F2026;opacity:0;transition:all ease-out .3s;-webkit-transform-style:preserve-3d;transform-style:preserve-3d}.post{position:relative;z-index:20}.post .post-meta{display:block;font-size:.75em;line-height:1.334em;font-weight:400;margin-bottom:1.334em}.post .post-title{position:relative;color:#000;font-size:2em;line-height:1.375em;font-weight:800;text-indent:-1px;margin:.25em 0 .75em}.post .post-title:before{position:absolute;left:0;bottom:-.334em;width:1em;margin-bottom:-2px}.post .post-header{padding:4em 0 0;margin-bottom:3em}.post-footer .post-share a span{display:none}.post-nav .post-nav-item{position:fixed;top:50%;display:block;margin-top:-4em;overflow:hidden;border-radius:10em;transition:none}@media only screen and (max-width:70em){.post-nav .post-nav-item{position:absolute;top:auto;margin:auto;max-width:50%}}.post-nav .post-nav-item.post-nav-next{left:0;text-align:left}.post-nav .post-nav-item.post-nav-next .post-nav-icon{float:left}.post-nav .post-nav-item.post-nav-next .post-nav-icon i{left:-.05em}.post-nav .post-nav-item.post-nav-next .post-nav-info{padding-left:6em}.post-nav .post-nav-item.post-nav-prev{right:0;text-align:right}.post-nav .post-nav-item.post-nav-prev .post-nav-icon{float:right}.post-nav .post-nav-item.post-nav-prev .post-nav-icon i{right:-.05em}.post-nav .post-nav-item.post-nav-prev .post-nav-info{padding-right:6em}.post-nav .post-nav-item .post-nav-teaser{display:block;padding:1em;transition:all ease-out .2s;max-width:25em;overflow:visible}.post-nav .post-nav-item .post-nav-teaser:after{clear:both;content:'';display:table}.post-nav .post-nav-item .post-nav-teaser .post-nav-icon{display:block;width:5em;height:5em;line-height:5em;text-align:center;box-sizing:border-box;border-radius:10em;border:1px solid #36D995;box-shadow:0 0 0 0 transparent;transition:all ease-out .1s;background:#F2F3F5}.post-nav .post-nav-item .post-nav-teaser .post-nav-icon i{position:relative;font-size:2em}@media only screen and (max-width:30em){.post-nav .post-nav-item .post-nav-teaser .post-nav-icon{width:4em;height:4em;line-height:4em}.post-nav .post-nav-item .post-nav-teaser .post-nav-icon i{font-size:1.5em}}.post-nav .post-nav-item .post-nav-teaser .post-nav-icon i:before{margin:auto}.post-nav .post-nav-item .post-nav-teaser .post-nav-info{display:none;width:100%;transition:all ease-out .2s}.post-nav .post-nav-item .post-nav-teaser .post-nav-info .post-nav-title{display:block;max-height:1.25em;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;margin:1.25em 0 .25em;font-size:1em;line-height:1.25em;font-weight:700;color:#363740}.post-nav .post-nav-item .post-nav-teaser .post-nav-info .post-nav-excerpt{display:block;max-height:1.334em;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;margin:0;font-size:.75em;line-height:1.334em;font-weight:400;color:#9D9FA6}
</style>

    
    </head>
    <body class="home-template">
      <section id="wrapper">
        <div id="ajax-container">
          <nav id="nav" class="nav">
            <div class="nav-logo">
              <a href="http://juju-sapphire.github.io">
                <img src="https://www.gravatar.com/avatar/1a2807faf3cca1667ff6f04bf5886eff.png" alt="Logo" />
              </a>
            </div>
            <div class="nav-menu">
              <a class="rss" href="">
                <i class="icon-rss"></i>
              </a>
              <a class="menu" data-action="menu" data-target="menu"><i class="icon-menu"></i></a>
            </div>
          </nav>


<main class="content" role="main">
	<article class="">
		<div class="inner">

			<div id="push">

  			<header class="post-header">
  				<span class="post-meta">
            <span class="post-date">27 Jan 2016</span>
  				</span>
  				<div class="clear"></div>
  				<h1 class="post-title">MAAS Spaces Demo</h1>
  			</header>

  			<section class="post-content">
  				

<p>In this post we are going to show you Juju 2.0s endpoint binding feature. By using endpoint binding you can deploy a bundle and have each service deployed into one or more spaces using a single command.</p>

<p>If that doesn&rsquo;t make much sense, don&rsquo;t worry, here is a quick run-down of what it means.</p>

<h2 id="bundle:f8823b7dea7671ceac9cf28baf027b39">Bundle</h2>

<p>In Juju a Charm is a recipe for deploying a <a href="https://jujucharms.com/docs/stable/charms-deploying">service</a>. For example the <a href="https://jujucharms.com/mariadb/">mariadb charm</a> tells Juju how to install mariadb and how it <a href="https://jujucharms.com/docs/stable/charms-relations">relates</a> to other services. A bundle instructs Juju how to deploy several charms and how those relationships should be configured.</p>

<h2 id="endpoint:f8823b7dea7671ceac9cf28baf027b39">Endpoint</h2>

<p>Continuing to use mariadb for our examples, mariadb exposes several relations, one of which is &ldquo;db&rdquo;. The combination of a service (mariadb) and a relation (db) is an endpoint.</p>

<h2 id="space:f8823b7dea7671ceac9cf28baf027b39">Space</h2>

<p>A Juju space defines a collection of subnets in which each machine in those subnets can directly talk to each other as well as sharing equivalent firewall rules.</p>

<h1 id="endpoint-binding-the-new-feature:f8823b7dea7671ceac9cf28baf027b39">Endpoint Binding - the new feature</h1>

<p>By binding an endpoint to a space a bundle can configure, for example, all database traffic to be routed over one space while all public facing internet traffic can be kept in another. This traffic separation can be used to isolate different types of traffic for security and performance management.</p>

<h1 id="on-with-the-show:f8823b7dea7671ceac9cf28baf027b39">On with the show!</h1>

<p>We will be using a customised version of the mediawiki bundle that deploys haproxy, mediawiki and mysql. It is pasted below and can be downloaded <a href="/files/MAAS%20Spaces%20Demo/bundle.yaml">here</a>. Traffic between haproxy and mediawiki is on a space called &ldquo;internal&rdquo; and traffic between mediawiki and mysql is in a space called &ldquo;db&rdquo;. The haproxy website endpoint is bound to the public space. This is all set up using the bindings section of each service.</p>

<p>You will need four machines to run this yourself. For this demonstration we will be placing each space in its own VLAN.</p>

<div class="highlight" style="background: #272822"><pre style="line-height: 125%"><span style="color: #ae81ff">services</span><span style="color: #f8f8f2">:</span>
  <span style="color: #ae81ff">haproxy</span><span style="color: #f8f8f2">:</span>
    <span style="color: #ae81ff">charm</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">cs:trusty/haproxy-13</span>
    <span style="color: #ae81ff">num_units</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">1</span>
    <span style="color: #ae81ff">bindings</span><span style="color: #f8f8f2">:</span>
        <span style="color: #ae81ff">website</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">public</span>
        <span style="color: #ae81ff">reverseproxy</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">internal</span>
        <span style="color: #ae81ff">peer</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">internal</span>
    <span style="color: #ae81ff">expose</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">true</span>
  <span style="color: #ae81ff">mediawiki</span><span style="color: #f8f8f2">:</span>
    <span style="color: #ae81ff">charm</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">cs:trusty/mediawiki-3</span>
    <span style="color: #ae81ff">num_units</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">1</span>
    <span style="color: #ae81ff">bindings</span><span style="color: #f8f8f2">:</span>
      <span style="color: #ae81ff">cache</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">internal</span>
      <span style="color: #ae81ff">website</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">internal</span>
      <span style="color: #ae81ff">db</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">db</span>
    <span style="color: #ae81ff">options</span><span style="color: #f8f8f2">:</span>
      <span style="color: #ae81ff">name</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">MAAS + Juju Network Spaces Wiki</span>
  <span style="color: #ae81ff">mysql</span><span style="color: #f8f8f2">:</span>
    <span style="color: #ae81ff">charm</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">cs:trusty/mysql-29</span>
    <span style="color: #ae81ff">num_units</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">1</span>
    <span style="color: #ae81ff">bindings</span><span style="color: #f8f8f2">:</span>
      <span style="color: #ae81ff">db</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">db</span>
      <span style="color: #ae81ff">cluster</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">internal</span>
<span style="color: #ae81ff">series</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">trusty</span>
<span style="color: #ae81ff">relations</span><span style="color: #f8f8f2">:</span>
<span style="color: #f8f8f2">-</span> <span style="color: #f8f8f2">-</span> <span style="color: #ae81ff">haproxy:reverseproxy</span>
  <span style="color: #f8f8f2">-</span> <span style="color: #ae81ff">mediawiki:website</span>
<span style="color: #f8f8f2">-</span> <span style="color: #f8f8f2">-</span> <span style="color: #ae81ff">mediawiki:db</span>
  <span style="color: #f8f8f2">-</span> <span style="color: #ae81ff">mysql:db</span>
</pre></div>


<p>Setting up VLANs, subnets and spaces in MAAS isn&rsquo;t difficult, but it is time consuming to go through all the steps yourself so we have put together a script to do it for you. It starts by reading the charm bundle you give it, then:</p>

<ol>
<li>For each space it finds in the bundle it will:

<ol>
<li>Create a VLAN in MAAS with a /24 subnet.</li>
<li>Create a space, then place the VLAN in that space.</li>
</ol></li>
<li>Then, for each unit in the charm bundle it will place a node in each VLAN the charm requires.</li>
<li>Put one node in all spaces for use as the bootstrap node.</li>
<li>Bootstrap the environment.</li>
<li>Deploy the charm.</li>
<li>Check that each endpoint is where it should be.</li>
</ol>

<p>The only prerequisite for the script is that the fabric that you will be creating VLANs on is called &ldquo;managed&rdquo;:
  1. <code>maas maas fabrics read</code>
<div class="highlight" style="background: #272822"><pre style="line-height: 125%"><span style="color: #f8f8f2">[</span>
    <span style="color: #f8f8f2">{</span>
        <span style="color: #f92672">&quot;resource_uri&quot;</span><span style="color: #f8f8f2">:</span> <span style="color: #e6db74">&quot;/MAAS/api/1.0/fabrics/0/&quot;</span><span style="color: #f8f8f2">,</span> 
        <span style="color: #f92672">&quot;vlans&quot;</span><span style="color: #f8f8f2">:</span> <span style="color: #f8f8f2">[</span>
            <span style="color: #f8f8f2">{</span>
                <span style="color: #f92672">&quot;name&quot;</span><span style="color: #f8f8f2">:</span> <span style="color: #e6db74">&quot;untagged&quot;</span><span style="color: #f8f8f2">,</span> 
                <span style="color: #f92672">&quot;vid&quot;</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">,</span> 
                <span style="color: #f92672">&quot;mtu&quot;</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">1500</span><span style="color: #f8f8f2">,</span> 
                <span style="color: #f92672">&quot;fabric&quot;</span><span style="color: #f8f8f2">:</span> <span style="color: #e6db74">&quot;fabric-0&quot;</span><span style="color: #f8f8f2">,</span> 
                <span style="color: #f92672">&quot;id&quot;</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">,</span> 
                <span style="color: #f92672">&quot;resource_uri&quot;</span><span style="color: #f8f8f2">:</span> <span style="color: #e6db74">&quot;/MAAS/api/1.0/vlans/0/&quot;</span>
            <span style="color: #f8f8f2">}</span>
        <span style="color: #f8f8f2">],</span> 
        <span style="color: #f92672">&quot;class_type&quot;</span><span style="color: #f8f8f2">:</span> <span style="color: #66d9ef">null</span><span style="color: #f8f8f2">,</span> 
        <span style="color: #f92672">&quot;name&quot;</span><span style="color: #f8f8f2">:</span> <span style="color: #e6db74">&quot;fabric-0&quot;</span><span style="color: #f8f8f2">,</span> 
        <span style="color: #f92672">&quot;id&quot;</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">0</span>
    <span style="color: #f8f8f2">},</span> 
    <span style="color: #f8f8f2">{</span>
        <span style="color: #f92672">&quot;resource_uri&quot;</span><span style="color: #f8f8f2">:</span> <span style="color: #e6db74">&quot;/MAAS/api/1.0/fabrics/1/&quot;</span><span style="color: #f8f8f2">,</span> 
        <span style="color: #f92672">&quot;vlans&quot;</span><span style="color: #f8f8f2">:</span> <span style="color: #f8f8f2">[</span>
            <span style="color: #f8f8f2">{</span>
                <span style="color: #f92672">&quot;name&quot;</span><span style="color: #f8f8f2">:</span> <span style="color: #e6db74">&quot;untagged&quot;</span><span style="color: #f8f8f2">,</span> 
                <span style="color: #f92672">&quot;vid&quot;</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">,</span> 
                <span style="color: #f92672">&quot;mtu&quot;</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">1500</span><span style="color: #f8f8f2">,</span> 
                <span style="color: #f92672">&quot;fabric&quot;</span><span style="color: #f8f8f2">:</span> <span style="color: #e6db74">&quot;fabric-1&quot;</span><span style="color: #f8f8f2">,</span> 
                <span style="color: #f92672">&quot;id&quot;</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">5001</span><span style="color: #f8f8f2">,</span> 
                <span style="color: #f92672">&quot;resource_uri&quot;</span><span style="color: #f8f8f2">:</span> <span style="color: #e6db74">&quot;/MAAS/api/1.0/vlans/5001/&quot;</span>
            <span style="color: #f8f8f2">}</span>
        <span style="color: #f8f8f2">],</span> 
        <span style="color: #f92672">&quot;class_type&quot;</span><span style="color: #f8f8f2">:</span> <span style="color: #66d9ef">null</span><span style="color: #f8f8f2">,</span> 
        <span style="color: #f92672">&quot;name&quot;</span><span style="color: #f8f8f2">:</span> <span style="color: #e6db74">&quot;fabric-1&quot;</span><span style="color: #f8f8f2">,</span> 
        <span style="color: #f92672">&quot;id&quot;</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">1</span>
    <span style="color: #f8f8f2">}</span>
  <span style="color: #f8f8f2">]</span>
</pre></div>

In my case I will be using the fabric that manages the subnet 192.168.1.0/24: <code>maas maas fabric update 1 name=managed</code></p>

<p>&hellip; run the script &hellip; the final output is:</p>

<pre><code>mediawiki/0 website 192.168.10.102 in internal
mediawiki/0 db 192.168.12.102 in db
haproxy/0 peer 192.168.10.101 in internal
haproxy/0 reverseproxy 192.168.10.101 in internal
mysql/0 cluster 192.168.10.103 in internal
mysql/0 db 192.168.12.103 in db
</code></pre>

<p>You can now access your mediawiki instance on the public address of the haproxy unit!</p>

  			</section>

  			<footer class="post-footer">
  				<div class="post-tags">
            
  				</div>
  				<div class="post-share">
  					<a class="icon-twitter" href="https://twitter.com/share?text=MAAS%20Spaces%20Demo&url=http%3a%2f%2fjuju-sapphire.github.io%2fMAAS%2520Spaces%2520Demo%2f" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
  						<span>Twitter</span>
  					</a>
  					<a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fjuju-sapphire.github.io%2fMAAS%2520Spaces%2520Demo%2f" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
  						<span>Facebook</span>
  					</a>
  					<a class="icon-gplus" href="https://plus.google.com/share?url=http%3a%2f%2fjuju-sapphire.github.io%2fMAAS%2520Spaces%2520Demo%2f" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
  						<span>Google+</span>
  					</a>
  				</div>
  			</footer>

  			<aside class="post-comments">
    
    
    
    
</aside>


			</div>

			<nav class="post-nav">
				
				
				<div class="clear"></div>
			</nav>

		</div>
	</article>
</main>

				<div id="body-class" style="display: none;"></div>
				<footer id="footer">
					<section class="credits">
						<span class="credits-theme">Theme <a href="https://github.com/zenithar/hugo-theme-bleak">Bleak</a> by <a href="http://zutrinken.com" rel="nofollow">zutrinken</a></span>
						<span class="credits-software">Published with <a href="http://gohugo.io">Hugo</a></span>
					</section>
				</footer>
				<div id="menu" data-target="menu">
	<div class="menu-header">
		<span class="menu-label">Menu</span>
		<a class="menu-close" data-action="menu" data-target="menu"></a>
	</div>
	<ul class="menu-list">
	</ul>
</div>
<div class="overlay"></div>

			</div>
		</section>

    <script>
      (function(c,f){asyncLoader=function(i,h){i.foreach(function(k,j){e(j,d(j),h)});if(typeof h.callback=="function"){var g=setInterval(function(){if(f.readyState==="complete"){clearInterval(g);h.callback()}},10)}};var d=function(g){var h=g.split(".");return h[h.length-1]},e=function(h,i,g){switch(i){case"js":a(h,g);break;case"css":b(h);break;default:break}},a=function(i,h){var g=document.createElement("script");g.type="text/javascript";g.async=true;g.src=i;document.getElementsByTagName("head")[0].appendChild(g)},b=function(g){var h=document.createElement("link");h.type="text/css";h.rel="stylesheet";h.href=g;document.getElementsByTagName("head")[0].appendChild(h)};Array.prototype.foreach=function(h){for(var g=0;g<this.length;g++){h(g,this[g])}}})(this,document);

      asyncLoader([
				"/js/dependencies.js",
				"/css/dependencies.css"
      ],{
        callback:function(){
					asyncLoader([
						"/css/style.css",
						"/js/script.js"
					], {
						callback: function() {}
					});
        }
      });
    </script>
	
	</body>
</html>

